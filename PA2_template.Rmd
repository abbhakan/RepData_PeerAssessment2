---
title: "Reproducible Research: Peer Assessment 2"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
Load the repdata-data-StormData.csv.bz2 file into workspace.
```{r}

library("R.utils")
if (!file.exists("./repdata-data-StormData.csv")) {        
        fileURL <- "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2"
        dest <- "./repdata-data-StormData.csv.bz2"
        download.file(fileURL, dest)
        bunzip2("./repdata-data-StormData.csv.bz2")
}
```
        
# Read data
Read the repdata-data-Stormdata.csv into data frame.
```{r}
data <- read.table("./repdata-data-StormData.csv", header = TRUE, sep = ",", na.strings = "", comment.char = "#")
cnames <-readLines("./repdata-data-StormData.csv", 1)
cnames <- strsplit(cnames, ",", fixed = TRUE)
cnames <- make.names(cnames[[1]])
cnames<-gsub("(.*)\\.", "\\1", cnames)
cnames<-gsub("_", "", cnames)
names(data) <- cnames
```
## Which types of events are most harmful with respect to population health?
Convert to data table and summarise injuries and fatalities then group by event type. Order by sum and display the top five items.
```{r}
library("data.table")
dt <- data.table(data)
res <- dt[, list(sum=sum(X.FATALITIES, X.INJURIES)), by = X.EVTYPE]
res <- res[rev(order(res$sum))]
head(res)
```
We can see that Tornado is causing the highest total sum of fatalities and injuries.

## Which types of events have the greatest economic consequences?
Convert to data table and summarise injuries and fatalities then group by event type. Order by sum and display the top five items.
```{r}
library("data.table")
dt <- data.table(data)
res <- dt[, list(sum=sum(X.FATALITIES, X.INJURIES)), by = X.EVTYPE]
res[rev(order(res$sum))]
```
We can see that Tornados is causing the highest total sum of fatalities and injuries.
